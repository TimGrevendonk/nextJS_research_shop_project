// link is used for client side navigation, the Link tag replaces the <a> tags.
import Link from "next/link";
import Head from 'next/head';
import Title from "../components/title";
import { useEffect, useState } from "react";
import { getProducts } from "../lib/products";


export default function HomePage() {
  // fetch data WHEN component is "mounted" like plain react component. 
  const [products, setProducts] = (
  // usestate hook returns parameter value in parentessis (empty array that binds to "products") and a function call (setProducts) to change the stata of "products".
    useState([]) 
  );
  // useEffect hook: execute function as soon as component IS mounted.
  useEffect(() => {
    // Http request to get products (asnyc so needs then or await).
    getProducts().then(setProducts);
    // getProducts().then((products) => setProducts(products)); // elaborative syntax method.
  // the empty array is the dependencies array, if empty it will only be executed once.
  }, []);

  console.log("[HomePage] render: ", products);
  return (
    <>
      <Head>
        <title>nextjs tim shop</title>
        <meta name="description" content="Generated by create next app" />
        {/* specifically mention from where the favicon should be loaded from relative from the public folder. */}
        <link rel="icon" href="/icons/favicon.ico" />
      </Head>
      <main className="homepage">
        <Title>NextJS tim shop <Link href="https://nextjs.org">Next.js!</Link></Title>
        <ul>
          {/* A foreach using map (mapping items into HTML outputs) */}
          {products.map((products) => (
            // Every react component needs a key.
            <li key={products.id}>
              {products.title}
            </li>
          ))}
          
        </ul>
      </main>
    </>
  )
}
